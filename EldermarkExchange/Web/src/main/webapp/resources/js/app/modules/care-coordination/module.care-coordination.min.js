ExchangeApp.modules.CareCoordination=function(){function t(){e().random=u.rand(),function(t,n){var a=e(),r=t||a.$html,o=n||a.random;r=u.randomize(r,o,!1)}(),function(t,n){var a=e();a.ajaxMap||(a.ajaxMap={});var o=t||a.$html,i=n||a.random,d=u.findAjaxUrls(o,i);$.each(d,function(t,e){a.ajaxMap[r(e,{params:!0})]=e}),u.find(o,i,'[data-ajax-load="true"]').on("click",function(){$(this).parent("li").parent("ul").children("li").each(function(){$(this).removeClass("active")}),$(this).parent("li").addClass("active");var t=$(this).attr("data-ajax-url-tmpl"),e=$(this).attr("data-ajax-url-vars"),n=$(this).attr("data-ajax-url-params"),a=u.getUrl(t,e,n);return c.route(a),!1}),u.find(o,i,'[data-ajax-anchor="true"]').on("click",function(){var t=$($(this).attr("href"));return t.length&&$("html, body").animate({scrollTop:t.offset().top},200),!1})}()}function e(){return i[r(d,{params:!0})]}function n(){return $(document.getElementById(a()))}function a(){return r(d,{params:!0}).replace(/[/&\?=]/g,"_")}function r(t,e){return u.stringifyUrl(t,e)}function o(t){var n=e();return u.find(n.$html,n.random,t)}var i={},d={template:"care-coordination"},s={reloadNeeded:!1},c=ExchangeApp.routers.ModuleRouter,u=ExchangeApp.utils.module,l=ExchangeApp.loaders.FragmentLoader.init("careCoordination"),h="care-coordination/communities/count",m="care-coordination/patients/count";return $.fn.clearForm=function(){return this.each(function(){var t=this.tagName.toLowerCase();if("form"===t)return $(':input:not([disabled="disabled"] ,[type="hidden"])',this).clearForm();var e=this.type;"text"===e||"password"===e||"textarea"===t?(this.value="",$(this).trigger("refresh")):"select"===t?(this.selectedIndex=0,$(this).trigger("refresh")):"checkbox"!==e&&"radio"!==e||(this.checked=!1,$(this).trigger("refresh"))})},{init:function(n){d=n,this.renderHolder(),this.loadFragment({onFragmentLoaded:function(){t()},onResourcesLoaded:function(){var t=e();t.widgets={},this.setEvents(),t.inited=!0,this.render(),this.show(),startListening(),this.loaded()}})},update:function(t){t&&(d=t),this.loaded()},getFragment:function(t){return i[r(t,{params:!0})]},isFragmentInited:function(t){var e=this.getFragment(t);return e&&e.inited},loadFragment:function(t){var e=this;l.load({url:d,callbacks:{onFragmentLoaded:function(n){s.reloadNeeded=!1;var a=$(n).find("#content .markup-frg"),o=r(d,{params:!0});i[o]={$html:a,url:u.clone(d)},t.onFragmentLoaded.apply(e)},onResourcesLoaded:function(){t.onResourcesLoaded.apply(e)}}})},render:function(){var t=e().$html;n().empty(),n().append(t)},renderHolder:function(){if(!document.getElementById(a())){var t=$("<div/>");t.attr("id",a()),t.hide(),$("#content").append(t)}},hide:function(){n().hide(),$("#content").addClass("loading")},show:function(){0==$("#content > div:visible").length&&n().show(),$("#content").removeClass("loading")},setEvents:function(){return ExchangeApp.managers.EventManager.subscribe("community_list_changed",function(){!function(){var t=o("#communityCountTabPanel");$.ajax({type:"GET",contentType:"json",url:h,success:function(e){t.html(e)}})}()}),ExchangeApp.managers.EventManager.subscribe("patients_list_changed",function(){!function(){var t=o("#patientsCountTabPanel");$.ajax({type:"GET",contentType:"json",url:m,success:function(e){t.html(e)}})}()}),!1},reloadNeeded:function(){return s.reloadNeeded},loaded:function(){$.each($(".baseHeader a.ldr-head-lnk.active"),function(){$(this).removeClass("active"),$(this).removeClass("bottom")}),$(".baseHeader a.ldr-head-lnk.careCoordinationLnk").addClass("active bottom")},routeToCommunityList:function(){o("#communitiesTab").find("a").click()}}}();