define([path("./IncidentReportForm")],function(o){function t(){Modal.apply(this,arguments);this.props.isReadonlyReport;this.state={isScrollerShowed:!1,isReportChangeIgnored:!1},this.scoringTooltip=null}var e=ExchangeApp.info.context+"/resources/images/arrow2-top.svg";return t.prototype=Object.create(Modal.prototype),t.prototype.constructor=t,t.prototype.getDefaultProps=function(){var o=this,t=Modal.prototype.getDefaultProps.apply(this);return $.extend({},t,{isStatic:!0,isReadonlyReport:!1,footerHeight:80,className:"",bodyExtraHeight:60,getTitle:function(){return o.props.isReadonlyReport?"View Incident Report":o.props.reportId>=0?"Edit Incident Report":"Create Incident Report"},renderFooter:function(){return{"<>":"div",class:"modal-footer scroller-container",html:[{"<>":"button",class:"btn btn-default",style:"margin-right: 24px;",text:"SUBMIT",onclick:function(){o.onSubmit()}},{"<>":"button",class:"btn btn-primary save-btn",text:"SAVE DRAFT",onclick:function(){o.onSaveDraft()}},{"<>":"div",title:"Back to Top",class:"up-scroller",html:[{"<>":"img",src:e}],onclick:function(){o.scrollToStart()}}]}},onLeaveReportUnchanged:function(){},onSaveReportDraftSuccess:function(){},onSaveReportDraftFailure:function(){},onSubmitReportSuccess:function(){},onSubmitReportFailure:function(){},onLoadReportFailure:function(){},onHide:function(){},onHidden:function(){}})},t.prototype.componentDidMount=function(){Modal.prototype.componentDidMount.apply(this),this.loader=new Loader({container:this.$body}),this.loader.mount();var t=this,e=this.props.eventId,r=this.props.reportId,n=this.props.patientId,i=this.props.currentUser,s=(this.props.reportDateModified,this.props.isReadonlyReport);this.form=new o({container:this.$body,eventId:e,reportId:r,patientId:n,isReadonly:s,currentUser:i,onLoading:function(o){t.setLoading(o)},onLoadFailure:function(o){t.props.onLoadReportFailure(o)},onValidationError:function(){var o=t.form.getInvalidFields();t.scrollTo(o.first())},onSubmitSuccess:function(o){t.props.onSubmitReportSuccess(o)},onSubmitFailure:function(o){t.props.onSubmitReportFailure(o)},onSaveDraftSuccess:function(o){t.props.onSaveReportDraftSuccess(o)},onSaveDraftFailure:function(o){t.props.onSaveReportDraftFailure(o)}}),this.form.mount(),this.addOnHideHandler(function(o){t.props.onHide(o)}),this.addOnHiddenHandler(function(o){t.props.onHidden(o),t.unmount()}),this.addOnScrollHandler(function(o){var e=o.target.scrollTop,r=o.target.clientHeight,n=t.state.isScrollerShowed;e>r/2?!n&&t.setState({isScrollerShowed:!0}):n&&t.setState({isScrollerShowed:!1})})},t.prototype.componentDidUpdate=function(o,t){var e=this.state.isScrollerShowed;e!==o.isScrollerShowed&&(e?this.showUpScroller():this.hideUpScroller())},t.prototype.componentWillUnmount=function(){this.form.unmount()},t.prototype.scrollToStart=function(){this.$body.scrollTo(0,500)},t.prototype.scrollTo=function(o){this.$body.scrollTo(o,500)},t.prototype.hideUpScroller=function(){this.$element.find(".up-scroller").hide()},t.prototype.showUpScroller=function(){this.$element.find(".up-scroller").show()},t.prototype.onSubmit=function(){this.form.onSubmit()},t.prototype.onSaveDraft=function(){this.form.onSaveDraft()},t.prototype.addOnScrollHandler=function(o){this.$body.on("scroll",o)},t.prototype.isReportChanged=function(o){return this.form.isChanged()},t.prototype.isReportChangeIgnored=function(o){return this.state.isReportChangeIgnored},t.prototype.ignoreReportChange=function(){return this.setState({isReportChangeIgnored:!0})},t.prototype.setLoading=function(o){o?(this.loader.show(),this.$body.css({overflow:"hidden"})):(this.loader.hide(),this.$body.css({overflow:"auto"}))},t.prototype.render=function(){var o=this.props.isStatic,t=this.props.isScrollable,e=!this.props.reportId,r=this.props.isReadonlyReport,n="modal fade incident-report-modal ",i="";return(i+=e?"new":r?"readonly":"edit")&&(n+=i+" "),{"<>":"div",class:n+this.props.className+(t?"":"non-scrollable"),"data-backdrop":!o||"static",html:[{"<>":"div",class:"modal-dialog",style:"width:1000px;",html:[{"<>":"div",class:"modal-content",html:[this.props.renderHeader(),this.props.renderBody(),this.props.renderFooter()]}]}]}},t});