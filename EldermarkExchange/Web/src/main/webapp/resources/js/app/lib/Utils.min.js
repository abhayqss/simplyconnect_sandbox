define(["underscore","date-math"],function(e,t){function n(e,t){for(e=String(e),t=t||2;e.length<t;)e="0"+e;return e}function r(e){(e=e||new Date)instanceof Date||(e=new Date(e));var t=e.toTimeString(),n=t.match(/\([a-z ]+\)/i);return n=n&&n[0]?(n=n[0].match(/[A-Z]/g))?n.join(""):void 0:(n=t.match(/[A-Z]{3,5}/g))?n[0]:void 0}var a=e.extend({MILLI:{second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5},format:function(e,t,i){var o=a.formats;if((e=e||new Date)instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");t=String(o[t]||t||o.default);var u=r(e),s=i?"getUTC":"get",d=e[s+"Date"](),m=e[s+"Day"](),f=e[s+"Month"](),l=e[s+"FullYear"](),c=e[s+"Hours"](),Y=e[s+"Minutes"](),M=e[s+"Seconds"](),h=i?0:e.getTimezoneOffset(),y=u.toLowerCase(),p=u.toUpperCase(),g={d:d,dd:n(d),ddd:a.i18n.dayNames[m],dddd:a.i18n.dayNames[m+7],M:f+1,MM:n(f+1),MMM:a.i18n.monthNames[f],MMMM:a.i18n.monthNames[f+12],YY:String(l).slice(2),YYYY:l,h:c%12||12,hh:n(c%12||12),H:c,HH:n(c),m:Y,mm:n(Y),s:M,ss:n(M),a:c<12?"a":"p",aa:c<12?"am":"pm",A:c<12?"A":"P",AA:c<12?"AM":"PM",o:(h>0?"-":"+")+n(100*Math.floor(Math.abs(h)/60)+Math.abs(h)%60,4),S:["th","st","nd","rd"][d%10>3?0:(d%100-d%10!=10)*d%10],z:"("+y+")",Z:"("+p+")"};return t.replace(/d{1,4}|M{1,4}|YY(?:YY)?|([HhmsAa])\1?|[oS]|[zZ]/g,function(e){return e in g?g[e]:e.slice(1,e.length-1)})},formats:{default:"YYYY/MM/dd",shortDate:"MM/dd",mediumDate:"YY/MM/dd",time12:"hh:mm AA",americanShortDate:"M/d/YYYY",americanMediumDate:"MM/dd/YYYY",separatedYearDate:"MMM dd, YYYY",separatedYearDateTime:"MMM dd, YYYY hh:mm AA",longDate:"YYYY/MM/dd",longDateTime:"YYYY/MM/dd HH:mm:ss",longDateMediumTime12:"MM/dd/YYYY hh:mm AA",longDateMediumTime12TimeZone:"MM/dd/YYYY hh:mm AA Z",isoDateTime:"YYYY-MM-ddTHH:mm:ss.000"},i18n:{dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},diffDates:function(e,t,n){var r=Math.abs(+e-+t);if(!n)return r;n=n.toLowerCase();var i=a.MILLI[n];if(i)return r/i;if("month"===n||"year"===n){var o=e<t,u=o?e:t,s=o?t:e,d=12*(a.year(s)-a.year(u))+a.month(s)-a.month(u);return a.date(s)-a.date(u)>=0&&d++,"month"===n?d:d/12}return r},isTomorrow:function(e){var t=a.startOf(new Date,"day"),n=a.startOf(e,"day");return 1===a.diff(t,n,"day")},isToday:function(e){var t=a.startOf(new Date,"day"),n=a.startOf(e,"day");return 0===a.diff(t,n,"day")},isYesterday:function(e){var t=a.startOf(new Date,"day"),n=a.startOf(e,"day");return 1===a.diff(n,t,"day")},getTimeZoneAbbr:r},t);return{getProperty:function(e,t){for(var n=(t=(t=(t+"").replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),r=0,a=n.length;r<a;++r){var i=n[r];if(!(i in e))return;e=e[i]}return e},extendProperty:function(t,n,r){if(n=(n+"").replace(/^\./,""),n=n.split("."),t)e.isArray(n)?n.length>1?t[n[0]]=this.extendProperty(t[n[0]],n.slice(1),r):t=this.extendProperty(t,n[0],r):t[n]=r;else if(t={},e.isArray(n))for(var a=r,i=n.length-1;i>=0;i--)(t={})[n[i]]=a,a=t;else t[n]=r;return t},emptyPromise:function(){return new Promise(function(e){e(null)})},capitalize:function(e){return e?e.charAt(0).toUpperCase()+e.slice(1):e},isEmptyStr:function(e){return"string"==typeof e&&""===e.trim()},isDateValid:function(e){return e.getTime()==e.getTime()},getTimeZoneAbbr:r,isNullOrUndefined:function(e){return null===e||void 0===e},isNull:function(e){return null===e},allAreNull:function(){return e.every(arguments,function(e){return this.isNull(e)})},anyIsNull:function(){return e.any(arguments,function(e){return this.isNull(e)})},isNotNull:function(e){return!this.isNull(e)},isNaN:function(t){return e.isNumber(t)&&t!==+t},isUndefined:function(e){return void 0===e},isEmpty:function(t){return!!(this.isNull(t)||this.isNaN(t)||this.isUndefined(t))||!!e.isObject(t)&&e.isEmpty(t)},isNotEmpty:function(e){return!this.isEmpty(e)},camel:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()}).replace(/\s+/g,"")},defer:function(t){return t=e.isNumber(t)?t:0,new Promise(function(e){setTimeout(e,t)})},interpolate:function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t++)e=e.replace(new RegExp("\\$".concat(t),"g"),t+1<1||arguments.length<=t+1?void 0:arguments[t+1]);return e},convertStringToBoolean:function(e){return!!e&&("true"===e||"false"!==e)},Date:a}});