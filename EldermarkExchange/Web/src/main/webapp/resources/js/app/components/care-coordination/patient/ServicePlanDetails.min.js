var ServicePlanDetails=function(t){function e(t){return!t||0===Object.keys(t).length}function o(){Widget.apply(this,arguments),this.form=null,this.state={data:{},isLoading:!1,currentUser:null}}var n=null,i=null;return ServiceProvider.getService("ServicePlanService").then(function(t){i=t}).fail(function(t){alert(t.message)}),ServiceProvider.getService("EmployeeService").then(function(t){n=t}).fail(function(t){alert(t.message)}),o.prototype=Object.create(Widget.prototype),o.prototype.constructor=o,o.prototype.getDefaultProps=function(){return{onSave:function(){},onLoadSuccess:function(){},onLoadFailure:function(){},onValidationError:function(){},onSaveSuccess:function(){},onSaveFailure:function(){},onShowDatePicker:function(){},onHideDatePicker:function(){},onNeedSectionAdded:function(){},onNeedSectionRemoved:function(){},onGoalSectionAdded:function(){}}},o.prototype.componentDidMount=function(){if(this.$element=t('[cmp-id="'+this.$$id+'"]'),this.loader=new Loader({container:this.$element}),this.loader.mount(),this.props.planId)this.load();else{var e=this;this.form=new ServicePlanForm({container:this.$element,isNew:!0,currentUser:this.props.currentUser,onShowDatePicker:function(){e.props.onShowDatePicker()},onHideDatePicker:function(){e.props.onHideDatePicker()},onNeedSectionAdded:function(t){e.props.onNeedSectionAdded(t)},onNeedSectionRemoved:function(){e.props.onNeedSectionRemoved()},onGoalSectionAdded:function(t,o){e.props.onGoalSectionAdded(t,o)}}),this.form.mount()}this.loadCurrentUser()},o.prototype.componentDidUpdate=function(t,o){var n=this.state.currentUser;n!==o.currentUser&&this.form&&this.form.update({currentUser:n});var i=this.state.data;if(!e(i)&&e(o.data)){var r=this;this.form=new ServicePlanForm({container:this.$element,isNew:!1,isReadonly:this.props.isReadonly,data:i,currentUser:this.props.currentUser,onNeedSectionAdded:function(t){r.props.onNeedSectionAdded(t)},onNeedSectionRemoved:function(){r.props.onNeedSectionRemoved()},onGoalSectionAdded:function(t,e){r.props.onGoalSectionAdded(t,e)}}),this.form.mount()}var s=this.state.isLoading;s!==o.isLoading&&this.setLoading(s)},o.prototype.load=function(){if(i){this.setState({isLoading:!0});var t=this.props.planId,e=this.props.patientId,o=this;i.findById(e,t).then(function(t){o.props.onLoadSuccess(t),o.setState({isLoading:!1,data:t})}).fail(function(t){o.props.onLoadFailure(t)})}},o.prototype.loadCurrentUser=function(){if(n){var t=this;n.find().then(function(e){t.setState({currentUser:e})})}},o.prototype.setLoading=function(t){t?(this.form&&this.form.hide(!1),this.loader.show()):(this.loader.hide(),this.form&&this.form.show(!1))},o.prototype.isValid=function(){this.form.updateValidation();var t=this.form.isValid();return t||this.props.onValidationError(),t},o.prototype.getInvalidItems=function(){return this.form.getInvalidFields()},o.prototype.getNeedSectionCount=function(){return this.form.getNeedSectionCount()},o.prototype.getNeedSection=function(t){return this.form.getNeedSection(t)},o.prototype.hasScoringSection=function(){return this.form.hasScoringSection()},o.prototype.createScoringSection=function(t){this.form.createScoringSection(t)},o.prototype.showScoringSection=function(t){this.form.showScoringSection(t)},o.prototype.hideScoringSection=function(t){this.form.hideScoringSection(t)},o.prototype.removeScoringSection=function(){this.form.removeScoringSection()},o.prototype.isChanged=function(){return this.form.isChanged()},o.prototype.save=function(){var t=this.form.getData(),e=!t.id,o=this.props.patientId,n=e?i.add:i.update;this.setLoading(!0);var r=this;n.apply(this,[o,t]).then(function(){r.setLoading(!1),r.props.onSaveSuccess()}).fail(function(t){r.setLoading(!1),r.props.onSaveFailure(t)})},o.prototype.render=function(){return{"<>":"div",class:"service-plan-details",html:[]}},o}($);